
move batch to worker class
    currently double processing some states


